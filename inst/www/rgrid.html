<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	
    <title>takiwaR</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/pure-min.css">
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/grids-responsive-old-ie-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/grids-responsive-min.css">
    <!--<![endif]-->
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    
    <link href="./css/style.css" rel="stylesheet">
</head>
<body>


<nav>
    <div class="main-menu pure-menu pure-menu-open pure-menu-horizontal">
        <a class="pure-menu-heading" href="./">takiwaR</a>
    </div>
</nav>

<div class="content-wrapper">
<div class="p-box">
<h1>Gretchen's Grid</h1>
<form class="pure-form pure-form-aligned">
<div class="pure-g">
<div class="pure-u-1 pure-u-md-1-3">
    <div class="p-box">
        <p>Site Safety</p>
        <fieldset>
            <div class="pure-control-group">
                <label for="N">N Quads</label>
                <input id="N" type="number" min="0" max="30" required value="10">
            </div>
            <div class="pure-control-group">
                <label for="W">River Width</label>
                <input id="W" type="text" min="0" max="100" required value="10">
            </div>
            
            <div class="pure-control-group">
            <label for="zero_is">Zero is ... ?</label>
            <select id="zero_is">
            	<option value="down">Downstream</option>
  				<option value="up">Upstream</option>
			</select>
            </div>
            
            
        </fieldset>
</div>

</form>

<div class="pure-g">
    <div class="pure-u-1">
    <div id="calc-result" class="p-box"></div>
    </div>  
    <div class="pure-g">
        <div class="pure-u-1"> 
        <button id="submitbutton" class="pure-button">Calculate Grid!</button>
        </div>
    </div>
</div>

<script src="./js/jquery-1.11.1.min.js"></script>
<script src="./js/opencpu-0.4.js"></script>
<script src="./js/TAKjs_addremove.js"></script>

<script>
//init this script when the page has loaded
$(document).ready(function(){
  $("#submitbutton").on("click", function(e){
    //alert("clicked")
    e.preventDefault();
    //disable the button to prevent multiple clicks
    $("#submitbutton").attr("disabled", "disabled");
    $("#calc-result").html("<p class='TAKui-secondary'>Please wait...</p>")
    
    var n = parseInt($("#N").val());
    var w = parseFloat($("#W").val());
    var zero_is = $("#zero_is").val();
    console.log(n)
    console.log(w)
       
    //perform the request
    var req = ocpu.call("sample_grid", {n:n, w:w, zero_is:zero_is}, function(session){
        session.getConsole(function(outtxt){
            //alert(outtxt);
            $("#calc-result").html("<p class='TAKui-success'>Success!</p><pre>" + outtxt + "</pre>");
        });
    });
    
    //if R returns an error, alert the error message
    req.fail(function(){
      $("#calc-result").html("<p class='TAKui-error'>Server error!</p><pre>" + req.responseText + "</pre>");
    });
    
    //after request complete, re-enable the button 
    req.always(function(){
      $("#submitbutton").removeAttr("disabled")
    });
  });
});
</script>



</body>
</html>
